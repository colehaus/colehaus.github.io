Elm.Native.Slider={},Elm.Native.Slider.make=function(r){if(r.Native=r.Native||{},r.Native.Slider=r.Native.Slider||{},r.Native.Slider.values)return r.Native.Slider.values;var n=ElmRuntime.use(ElmRuntime.Render.Utils).newElement,u=Elm.Graphics.Element.make(r).newElement;function a(e){var t=n("input");return t.type="range",t.min=e.styling.min,t.max=e.styling.max,t.step=e.styling.step,t.value=e.styling.value,e.styling.horizontal||(t.orient="vertical",t.style.webkitAppearance="slider-vertical",t.style.writingMode="bt-lr"),e.styling.disabled&&(t.disabled=!0),t.style.display="block",t.style.pointerEvents="auto",t.elm_signal=e.signal,t.elm_handler=e.handler,t.addEventListener("input",function(){r.notify(t.elm_signal.id,t.elm_handler(t.value))}),t}function c(e,t,r){r.styling.disabled?e.disabled=!0:e.disabled=!1,e.elm_signal=r.signal,e.elm_handler=r.handler,e.min=r.styling.min,e.max=r.styling.max,e.step=r.styling.step,e.value=r.styling.value}return r.Native.Slider.values={slider:F3(function(e,t,r){var n=r.length,o=24;if(!r.horizontal){var i=n;n=o,o=i}return A3(u,n,o,{ctor:"Custom",type:"Slider",render:a,update:c,model:{signal:e,handler:t,styling:r}})})}},Elm.Automaton=Elm.Automaton||{},Elm.Automaton.make=function(e){"use strict";if(e.Automaton=e.Automaton||{},e.Automaton.values)return e.Automaton.values;var t,r=Elm.Native,a=r.Utils.make(e),c=r.List.make(e),s=(r.Array.make(e),r.Error.make(e)),l="Automaton",m=Elm.Basics.make(e),n=(Elm.Cell.make(e),Elm.Color.make(e)),p=Elm.Graphics.Collage.make(e),_=Elm.Graphics.Element.make(e),o=Elm.Graphics.Input.make(e),f=Elm.Grid.make(e),i=Elm.List.make(e),A=Elm.Optics.Lens.make(e),d=(Elm.Pseudorandom.make(e),Elm.Render.make(e)),u=Elm.Signal.make(e),h=Elm.Slider.make(e),k=Elm.String.make(e),v=Elm.Text.make(e),E=Elm.Ticks.make(e),g=Elm.Transition.make(e),F=Elm.Window.make(e),T=a.replace([["typeface",c.fromArray(["Open sans"])],["color",A3(n.rgb,24,18,30)]],v.defaultStyle),y=function(e){return v.leftAligned(v.style(T)(v.toText(e)))},w=A2(i.indexedMap,F2(function(e,t){return{ctor:"_Tuple2",_0:m.toFloat(e)/3,_1:t}}),c.fromArray([0,1,10,100])),b=F2(function(e,t){return r=A2(n.linear,{ctor:"_Tuple2",_0:m.toFloat(e)/-2,_1:0},{ctor:"_Tuple2",_0:m.toFloat(e)/2,_1:0})(i.map(A2(A.over,A.snd_,function(e){return t(d.toAlpha(e))}))(w)),A2(p.gradient,r,A2(p.rect,m.toFloat(e),10));var r}),C=function(t){return p.group(A2(i.map,function(e){return function(){switch(e.ctor){case"_Tuple2":return p.moveX(m.toFloat(t)*e._0*.95)(p.toForm(y(k.show(e._1))))}s.Case(l,"between lines 85 and 86")}()},w))},L=function(e){return t=y("Wealth"),r=_.sizeOf(t),n=function(){switch(r.ctor){case"_Tuple2":return r._0}s.Case(l,"on line 100, column 16 to 34")}(),o=e-n-30,i=A2(_.flow,_.down,c.fromArray([y("Capital-managed firms"),A3(p.collage,o,35,c.fromArray([p.moveY(15)(A2(b,o,d.capitalColor)),p.moveX(m.toFloat(o)/-4*1.95)(C(o)),p.moveY(-15)(A2(b,o,d.laborColor))])),y("Labor-managed firms")])),r=_.sizeOf(i),u=function(){switch(r.ctor){case"_Tuple2":return r._1}s.Case(l,"on line 111, column 16 to 35")}(),A2(_.flow,_.right,c.fromArray([A3(_.container,n,u,_.middle)(t),A2(_.spacer,10,u),i]));var t,r,n,o,i,u},P=A2(E.totalTicks,u.constant(.002),E.run.signal),O=F6(function(e,t,r,n,o,i){return a.eq(t,e)?{ctor:"_Tuple4",_0:o,_1:r,_2:n,_3:e}:{ctor:"_Tuple4",_0:(u=g.autoStep(A2(A._op["@~"],f.altruism,i)(o))(r))._0,_1:u._1,_2:n,_3:t};var u}),x=F2(function(r,n){return function(){switch(n.ctor){case"_Tuple4":return function(){switch(r.ctor){case"_Tuple3":switch(r._0){case 0:switch(r._1.ctor){case"Reseed":return{ctor:"_Tuple4",_0:(t=f.init(r._2)(n._1))._0,_1:t._1,_2:n._1,_3:0};case"Reset":return{ctor:"_Tuple4",_0:(e=f.init(r._2)(n._2))._0,_1:e._1,_2:n._2,_3:0}}}switch(r._1.ctor){case"Pause":return{ctor:"_Tuple4",_0:n._0,_1:n._1,_2:n._2,_3:n._3};case"Play":case"Step":return A6(O,n._3,r._0,n._1,n._2,n._0,r._2)}}var e,t;s.Case(l,"between lines 62 and 69")}()}s.Case(l,"between lines 62 and 69")}()}),M=o.input(0),I=A3(h.slider,M.handle,m.identity,a.replace([["max",1],["step",.01]],h.defaultSlider)),S=F.width,N=2348912,R={ctor:"_Tuple4",_0:(t=f.init(0)(N))._0,_1:t._1,_2:N,_3:0},G=A2(u._op["<~"],function(e){return function(){switch(e.ctor){case"_Tuple4":return e._0}s.Case(l,"on line 58, column 26 to 27")}()},A3(u.foldp,x,R,A2(u._op["~"],A2(u._op["~"],A2(u._op["<~"],F3(function(e,t,r){return{ctor:"_Tuple3",_0:e,_1:t,_2:r}}),P),E.run.signal),M.signal))),$=A2(u._op["~"],A2(u._op["~"],A2(u._op["<~"],F3(function(e,t,r){return A2(_.flow,_.down,c.fromArray([L(r),A2(d.render,r,t),A2(_.spacer,1,5),A2(_.flow,_.right,c.fromArray([y("Altruism:"),A2(_.spacer,10,1),I,A2(_.spacer,10,1),y("Generation:"),A2(_.spacer,10,1),y(k.show(e))])),A2(_.spacer,1,5),E.playControls]))}),P),G),S);return e.Automaton.values={_op:{},seed:N,gridLength:25,gridSize:S,main:$,initState:R,altruism:M,altSlider:I,grid:G,update:x,step:O,ticks:P,labelSquish:.95,labels:C,stops:w,legend:b,legends:L,plainText$:y,textStyle:T},e.Automaton.values},Elm.Transition=Elm.Transition||{},Elm.Transition.make=function(e){"use strict";if(e.Transition=e.Transition||{},e.Transition.values)return e.Transition.values;var t=Elm.Native,m=t.Utils.make(e),a=t.List.make(e),p=(t.Array.make(e),t.Error.make(e)),_="Transition",c=Elm.Array.make(e),r=Elm.Basics.make(e),f=Elm.Cell.make(e),n=Elm.Dict.make(e),s=Elm.Either.make(e),A=Elm.Grid.make(e),o=Elm.List.make(e),d=Elm.Maybe.make(e),h=Elm.Optics.Lens.make(e),i=Elm.Optics.Prism.make(e),k=Elm.Optics.Traversal.make(e),v=Elm.Pseudorandom.make(e),E=Elm.Pseudorandom.Infix.make(e),u=n.map(A2(h.set,A.clean,!0)),l=n.filter(F2(function(e,t){return r.not(A2(h._op["^@"],t,A.clean))})),g=function(t){return function(e){return o.last(o.sortBy(t)(c.toList(e)))}},F=function(e){return A2(k._op["##"],A.groupAt(e),A2(k._op["@#"],A.groupType,A2(k._op["?@"],A.capitalGroup,A.accum)))},T=F3(function(e,t,r){return function(){switch(e.ctor){case"Left":return A2(k._op["#%"],A2(k._op["@#"],A.groups,F(e._0)),function(e){return e-t})(r);case"Right":return A2(k._op["#%"],A2(k._op["@#"],A.grid,A2(k._op["##"],A.index(e._0),A2(k._op["?@"],f.firm,f.accum))),function(e){return e-t})(r)}p.Case(_,"between lines 107 and 109")}()}),y=A2(r.flip,d.maybe,r.identity),w=F2(function(t,e){return function(){switch(A2(h._op["^@"],t,f.firmType).ctor){case"MkCapital":return{ctor:"_Tuple2",_0:A2(h._op["@%"],f.accum,F2(function(e,t){return e+t})(A2(h._op["^@"],t,f.laborProfit)))(t),_1:A2(k._op["#%"],F(A2(h._op["^@"],t,f.groupId)),F2(function(e,t){return e+t})(A2(h._op["^@"],t,f.capitalProfit)))(e)};case"MkLabor":return{ctor:"_Tuple2",_0:A2(h._op["@%"],f.accum,function(e){return e+A2(h._op["^@"],t,f.laborProfit)+A2(h._op["^@"],t,f.capitalProfit)})(t),_1:e}}p.Case(_,"between lines 60 and 68")}()}),b=F5(function(a,c,s,l,e){return function(){var u=A2(i._op["^?"],e,f.firm);switch(u.ctor){case"Just":return A2(E._op["<$>"],function(e){return m.cmp(e,.2)<0?function(){var e,t,r,n,o,i=A2(h._op["^@"],u._0,f.firmType);switch(i.ctor){case"MkCapital":return r=A2(h._op["^@"],u._0,f.groupId),t=A2(k._op["!#"],c,A2(k._op["##"],A.groupAt(r),A2(k._op["@?"],A.groupType,A.capitalGroup))),n=function(){switch(t.ctor){case"Just":return t._0}p.Case(_,"on line 155, column 37 to 38")}(),o=A2(h._op["^@"],n,A.accum),m.cmp(A2(h._op["^@"],s,f.cost),o)<0&&m.cmp(A2(h._op["^@"],s,f.cost),A2(h._op["^@"],n,A.threshold))<0?d.Just({ctor:"_Tuple3",_0:A2(h._op["^@"],n,A.threshold),_1:r,_2:d.Nothing}):d.Nothing;case"MkLabor":return e=A2(h._op["^@"],u._0,f.accum),m.cmp(A2(h._op["^@"],s,f.cost),e)<0&&m.cmp(A2(h._op["^@"],s,f.cost),A2(h._op["^@"],i._0,f.threshold)(a))<0?d.Just({ctor:"_Tuple3",_0:A2(h._op["^@"],i._0,f.threshold)(a),_1:A2(h._op["^@"],u._0,f.groupId),_2:d.Just(l)}):d.Nothing}p.Case(_,"between lines 147 and 161")}():d.Nothing},v.$float);case"Nothing":return v.constant(d.Nothing)}p.Case(_,"between lines 141 and 161")}()}),C=F3(function(i,e,u){return A2(E._op["=<<"],function(e){return m.eq(e,c.empty)?v.constant(d.Nothing):(t=A2(h._op["^@"],i,A.generation),r=A2(g,function(e){return function(){switch(e.ctor){case"_Tuple3":return e._0}p.Case(_,"on line 119, column 53 to 54")}()},e),n=function(){switch(r.ctor){case"_Tuple3":return r._1}p.Case(_,"on line 119, column 28 to 65")}(),o=function(){switch(r.ctor){case"_Tuple3":return r._2}p.Case(_,"on line 119, column 28 to 65")}(),function(){switch(o.ctor){case"Just":return A2(E._op["<$>"],function(e){return d.Just({ctor:"_Tuple3",_0:A3(f.defLabor,.2*e,t,n),_1:A2(h._op["^@"],u,f.cost),_2:s.Right(o._0)})},v.$float);case"Nothing":return v.constant(d.Just({ctor:"_Tuple3",_0:A2(f.defCapital,t,n),_1:A2(h._op["^@"],u,f.cost),_2:s.Left(n)}))}p.Case(_,"between lines 121 and 129")}());var t,r,n,o},v.lift(A.filterMap(r.identity))(A.combine(A.indexedMap(A3(b,A2(h._op["^@"],i,A.altruism),A2(h._op["^@"],i,A.groups),u))(A2(A.neighbors,A2(h._op["^@"],i,A.grid),e)))))}),L=A2(E._op["=<<"],function(e){return m.cmp(e,.1)<0?A2(E._op["<$>"],d.Just,f.defEmpty):v.constant(d.Nothing)},v.$float),P=F3(function(t,r,n){return A2(E._op["=<<"],function(e){return m.cmp(e,.001)<0?A2(E._op["<$>"],function(e){return d.Just({ctor:"_Tuple2",_0:A2(f.defCapital,t,r),_1:A2(k._op["#~"],A.groupAt(r),a.fromArray([A.defCapital(.2*e)]))(n)})},v.$float):m.cmp(e,.002)<0?A2(E._op["<$>"],function(e){return d.Just({ctor:"_Tuple2",_0:A3(f.defLabor,.2*e,t,r),_1:A2(k._op["#~"],A.groupAt(r),a.fromArray([A.defLabor]))(n)})},v.$float):v.constant(d.Nothing)},v.$float)}),O=F3(function(e,i,u){return function(){var o=A2(k._op["!#"],u,A2(k._op["@#"],A.grid,A.index(i)));switch(o.ctor){case"Just":switch(o._0.ctor){case"MkEmpty":return A2(E._op["=<<"],function(e){return function(){switch(e.ctor){case"Just":switch(e._0.ctor){case"_Tuple3":return v.constant(A2(h._op["@%"],A.groups,A.dirty(e._0._0))(A2(k._op["#~"],A2(k._op["@#"],A.grid,A.index(i)),a.fromArray([f.MkFirm(e._0._0)]))(A3(T,e._0._2,e._0._1,u))))}break;case"Nothing":return A2(E._op["<$>"],function(e){return function(){switch(e.ctor){case"Just":switch(e._0.ctor){case"_Tuple2":return A2(h._op["@~"],A.groups,e._0._1)(A2(k._op["#~"],A2(k._op["@#"],A.grid,A.index(i)),a.fromArray([f.MkFirm(e._0._0)]))(u))}break;case"Nothing":return u}p.Case(_,"between lines 88 and 93")}()},A3(P,A2(h._op["^@"],u,A.generation),A2(A.genGroupId,A2(h._op["^@"],u,A.generation),i),A2(h._op["^@"],u,A.groups)))}p.Case(_,"between lines 81 and 94")}()},A3(C,e,i,o._0._0));case"MkFirm":return A2(E._op["<$>"],function(n){return function(){switch(n.ctor){case"Just":return A2(k._op["#~"],A2(k._op["@#"],A.grid,A.index(i)),a.fromArray([f.MkEmpty(n._0)]))(u);case"Nothing":return e=A2(w,o._0._0,A2(h._op["^@"],u,A.groups)),t=e._0,r=e._1,A2(h._op["@~"],A.groups,A2(A.dirty,t,r))(A2(k._op["#~"],A2(k._op["@#"],A.grid,A.index(i)),a.fromArray([f.MkFirm(t)]))(u))}var e,t,r;p.Case(_,"between lines 97 and 103")}()},L)}}p.Case(_,"between lines 78 and 103")}()});return e.Transition.values={_op:{},abioP:.001,deathP:.1,claimP:.2,maxDiscount:.2,abiogenesis:P,death:L,accum:w,fromMaybe:y,groupAccum:F,cellStep:O,subCost:T,grow:C,maximumBy:g,claim:b,sweep:l,clean:u,autoStep:function(r){return A2(E._op["<$>"],function(e){return A2(h.over,A.groups,function(e){return u(l(e))})(A2(h.over,A.generation,F2(function(e,t){return e+t})(1))(e))},A3(A.foldl,F2(function(e,t){return A2(E._op["=<<"],A2(O,r,e),t)}),v.constant(r),A.indices))}},e.Transition.values},Elm.Render=Elm.Render||{},Elm.Render.make=function(e){"use strict";if(e.Render=e.Render||{},e.Render.values)return e.Render.values;var t=Elm.Native,s=t.Utils.make(e),l=t.List.make(e),m=(t.Array.make(e),t.Error.make(e)),p="Render",_=Elm.Array.make(e),f=Elm.Basics.make(e),A=Elm.Cell.make(e),d=Elm.Color.make(e),h=Elm.Dict.make(e),k=Elm.Graphics.Collage.make(e),v=(Elm.Graphics.Element.make(e),Elm.Grid.make(e)),E=Elm.List.make(e),g=Elm.Maybe.make(e),F=Elm.Optics.Lens.make(e),T=Elm.Optics.Prism.make(e),y=Elm.Optics.Traversal.make(e),w=function(e){return t=k.solid(e),s.replace([["width",2]],t);var t},b=F3(function(o,i,u){return function(){switch(u.ctor){case"_Tuple2":return function(){switch(i.ctor){case"_Tuple2":return s.eq(i._1,u._1)?(r=function(e){return A2(k.segment,{ctor:"_Tuple2",_0:e,_1:f.toFloat(i._1*o)},{ctor:"_Tuple2",_0:e,_1:f.toFloat((i._1+1)*o)})},n=f.toFloat(i._0*o),{ctor:"_Tuple2",_0:r(n+.5),_1:r(n-.5)}):s.eq(i._0,u._0)?(e=function(e){return A2(k.segment,{ctor:"_Tuple2",_0:f.toFloat(i._0*o),_1:e},{ctor:"_Tuple2",_0:f.toFloat((i._0+1)*o),_1:e})},t=f.toFloat(i._1*o),{ctor:"_Tuple2",_0:e(t+.5),_1:e(t-.5)}):m.If(p,"between lines 63 and 70")}var e,t,r,n;m.Case(p,"between lines 63 and 70")}()}m.Case(p,"between lines 63 and 70")}()}),o=function(e){return f.floor(f.toFloat(e)/f.toFloat(v.length))},r=function(e){return k.move({ctor:"_Tuple2",_0:f.toFloat(e)/-2,_1:f.toFloat(e)/-2})},C=function(e){return 1-1/A2(f.logBase,f.e,f.e+A2(f.max,e,0))*.8},n=F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:e(t._0),_1:e(t._1)}}m.Case(p,"on line 35, column 18 to 26")}()}),i=F2(function(e,t){return function(e){return k.move(n(function(e){return f.toFloat(e)*f.toFloat(t)+f.toFloat(t)/2})(e))}}),u=A3(d.rgba,156,69,53),L=A3(d.rgb,215,233,215),a=A3(d.rgba,57,147,57),P=A3(d.rgba,116,46,153),c=function(e){return function(){switch(e.ctor){case"MkEmpty":return u(C(A2(F._op["^@"],e._0,A.cost)));case"MkFirm":return function(){switch(A2(F._op["^@"],e._0,A.firmType).ctor){case"MkCapital":return P(C(A2(F._op["^@"],e._0,A.accum)));case"MkLabor":return a(C(A2(F._op["^@"],e._0,A.accum)))}m.Case(p,"between lines 53 and 55")}()}m.Case(p,"between lines 50 and 55")}()},O=F2(function(r,e){return n=o(r),t=F2(function(e,t){return A3(i,r,n,e)(k.filled(c(t))(k.square(f.toFloat(n))))}),k.group(v.toList(A2(v.indexedMap,t,e)));var n,t}),x=F3(function(a,c,e){return r=F3(function(o,i,u){return function(){switch(i.ctor){case"_Tuple2":return function(){switch(o.ctor){case"_Tuple2":return s.eq(A2(y._op["!#"],o._1,A2(y._op["?@"],A.firm,A.groupId)),A2(y._op["!#"],i._1,A2(y._op["?@"],A.firm,A.groupId)))?u:(e=F2(function(n,e){return g.map(function(r){return function(){var e,t;switch(A2(F._op["^@"],r,A.firmType).ctor){case"MkCapital":return e=A2(y._op["!#"],A2(h.getOrFail,A2(F._op["^@"],r,A.groupId),c),A2(y._op["@#"],v.groupType,A2(y._op["?@"],v.capitalGroup,v.accum))),t=function(){switch(e.ctor){case"Just":return e._0}m.Case(p,"on line 87, column 43 to 44")}(),k.group(l.fromArray([A2(k.traced,w(d.white),n),A2(k.traced,w(P(C(t))),n)]));case"MkLabor":return A2(k.traced,w(L),n)}m.Case(p,"between lines 85 and 94")}()})(A2(T._op["^?"],e,A.firm))}),t=A3(b,a,o._0,i._0),r=t._0,n=t._1,_.append(u)(_.fromList(A2(E.filterMap,f.identity,l.fromArray([A2(e,r,o._1),A2(e,n,i._1)])))))}var e,t,r,n;m.Case(p,"between lines 80 and 97")}()}m.Case(p,"between lines 80 and 97")}()}),s.eq(e,_.empty)?_.empty:f.snd(A3(_.foldl,F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:e,_1:A3(r,e,t._0,t._1)}}m.Case(p,"on line 100, column 40 to 58")}()}),{ctor:"_Tuple2",_0:A2(_.getOrFail,0,e),_1:_.empty},A3(_.slice,1,_.length(e),e)));var r}),M=F2(function(e,t){return r=o(e),n=function(e){return A3(e,function(e){return _.append(A2(x,r,A2(F._op["^@"],t,v.groups))(e))},_.empty,A2(F._op["^@"],t,v.grid))},k.group(_.toList(A2(_.append,n(v.indexedFoldFromBottom),n(v.indexedFoldFromLeft))));var r,n}),I=F2(function(e,t){return A3(k.collage,e,e,l.fromArray([r(e)(A2(O,e,A2(F._op["^@"],t,v.grid))),r(e)(A2(M,e,t))]))});return e.Render.values={_op:{},capitalColor:P,laborColor:a,laborAt0:L,emptyColor:u,both:n,toAlpha:C,botLeft:r,positionCell:i,color:c,cellSize:o,border:b,borderStyle:w,lineOfBorders:x,borders:M,cells:O,render:I},e.Render.values},Elm.Grid=Elm.Grid||{},Elm.Grid.make=function(e){"use strict";if(e.Grid=e.Grid||{},e.Grid.values)return e.Grid.values;var t=Elm.Native,u=t.Utils.make(e),n=t.List.make(e),o=(t.Array.make(e),t.Error.make(e)),i="Grid",a=Elm.Array.make(e),r=Elm.Basics.make(e),c=Elm.Cell.make(e),s=Elm.Dict.make(e),l=Elm.Either.make(e),m=Elm.Maybe.make(e),p=Elm.Optics.Lens.make(e),_=Elm.Optics.Prism.make(e),f=Elm.Optics.Traversal.make(e),A=Elm.Pseudorandom.make(e),d=Elm.Pseudorandom.Infix.make(e),h=a.foldl,k=a.filter,v=a.empty,E=a.map,g=A.combineA,F=A.mapA,T=a.fromList,y=a.foldr,w=a.toList,b=A2(m.maybe,n.fromArray([]),function(e){return n.fromArray([e])}),C=A2(a.foldr,a.push,a.empty),L=F3(function(n,e,t){return o=F2(function(t,r){return function(){var e={ctor:"_Tuple2",_0:A2(a.get,0,t),_1:A2(a.get,0,r)};switch(e.ctor){case"_Tuple2":switch(e._0.ctor){case"Just":switch(e._1.ctor){case"Just":return A2(a.push,A2(n,e._0._0,e._1._0),A2(o,A3(a.slice,1,a.length(t),t),A3(a.slice,1,a.length(r),r)))}}}return a.empty}()}),C(A2(o,e,t));var o}),P=F3(function(t,r,n){return function(){var e=t(r);switch(e.ctor){case"Just":return A2(a.push,e._0,n);case"Nothing":return n}o.Case(i,"between lines 137 and 139")}()}),O=function(e){return A2(a.foldl,P(e),a.empty)},x=A2(p.Lens,function(e){return e.groupType},F2(function(e,t){return u.replace([["groupType",e]],t)})),M=A2(p.Lens,function(e){return e.clean},F2(function(e,t){return u.replace([["clean",e]],t)})),I=A2(p.Lens,function(e){return e.threshold},F2(function(e,t){return u.replace([["threshold",e]],t)})),S=A2(p.Lens,function(e){return e.accum},F2(function(e,t){return u.replace([["accum",e]],t)})),N=F2(function(e,t){return{_:{},accum:e,threshold:t}}),R={ctor:"MkLabor"},G=function(e){return{ctor:"MkCapital",_0:e}},$=A2(_.Prism,G,function(e){return function(){switch(e.ctor){case"MkCapital":return l.Right(e._0)}return l.Left(e)}()}),J=F2(function(e,t){return{_:{},clean:e,groupType:t}}),B=A2(J,!1,R),U=A2(p.Lens,function(e){return e.groups},F2(function(e,t){return u.replace([["groups",e]],t)})),q=A2(p.Lens,function(e){return e.grid},F2(function(e,t){return u.replace([["grid",e]],t)})),z=A2(p.Lens,function(e){return e.altruism},F2(function(e,t){return u.replace([["altruism",e]],t)})),D=A2(p.Lens,function(e){return e.generation},F2(function(e,t){return u.replace([["generation",e]],t)})),j=F4(function(e,t,r,n){return{_:{},altruism:n,generation:r,grid:e,groups:t}}),W=F3(function(e,t,r){return n=a.length(r),u.eq(n,25)?A2(e,r,t):A3(W,e,A2(e,A3(a.slice,0,25,r),t),A3(a.slice,25,a.length(r),r));var n}),X=F3(function(n,e,o){return i=F2(function(t,e){return u.eq(t,25)?e:(r=A2(a.initialize,25,function(e){return A2(a.getOrFail,25*e+t,o)}),i(t+1)(A2(n,r,e)));var r}),A2(i,0,e);var i}),Y=function(t){return function(){switch(t.ctor){case"_Tuple2":return A2(f.Traversal,function(e){return b(a.get(25*t._0+t._1)(e))},function(e){return function(){switch(e.ctor){case"::":switch(e._1.ctor){case"[]":return A2(a.set,25*t._0+t._1,e._0)}}o.Case(i,"on line 143, column 39 to 67")}()})}o.Case(i,"between lines 142 and 143")}()},H=A2(a.initialize,Math.pow(25,2),function(e){return{ctor:"_Tuple2",_0:e/25|0,_1:A2(r.rem,e,25)}}),K=function(e){return A2(L,e,H)},Q=F2(function(t,r){return function(e){return A2(W,t,r)(K(F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}))(e))}}),V=F2(function(t,r){return function(e){return A2(X,t,r)(K(F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}))(e))}}),Z=F3(function(r,e,t){return A2(a.foldl,F2(function(e,t){return function(){switch(e.ctor){case"_Tuple2":return A3(r,e._0,e._1,t)}o.Case(i,"on line 126, column 49 to 58")}()}),e)(A2(K,F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}),t))}),ee=F2(function(r,e){return function(){switch(e.ctor){case"_Tuple2":return t=function(e){return-1<u.cmp(e,0)&&u.cmp(e,25)<0},O(function(e){return function(){switch(e.ctor){case"_Tuple2":return t(e._0)&&t(e._1)?A2(f._op["!#"],r,Y({ctor:"_Tuple2",_0:e._0,_1:e._1})):m.Nothing}o.Case(i,"between lines 164 and 166")}()})(a.fromList(n.fromArray([{ctor:"_Tuple2",_0:e._0+1,_1:e._1},{ctor:"_Tuple2",_0:e._0-1,_1:e._1},{ctor:"_Tuple2",_0:e._0,_1:e._1+1},{ctor:"_Tuple2",_0:e._0,_1:e._1-1}])))}var t;o.Case(i,"between lines 162 and 171")}()}),te=F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return(25*t._0+t._1)*e}o.Case(i,"on line 174, column 24 to 43")}()});return e.Grid.values={_op:{},length:25,init:function(t){return A2(d._op["<$>"],function(e){return A4(j,e,s.empty,1,t)},A.combineA(A2(a.repeat,Math.pow(25,2),A2(d._op["<$>"],c.MkEmpty,c.defEmpty))))},Automaton:j,groupAt:function(r){return A2(f.Traversal,function(e){return b(s.get(r)(e))},F2(function(e,t){return function(){switch(e.ctor){case"::":switch(e._1.ctor){case"[]":return A3(s.insert,r,e._0,t)}break;case"[]":return A2(s.remove,r,t)}o.Case(i,"between lines 44 and 46")}()}))},generation:D,altruism:z,grid:q,groups:U,Group:J,MkCapital:G,MkLabor:R,CapitalGroup:N,defCapital:function(e){return J(!1)(G(N(0)(c.capitalShare*c.stepProfit/(1-(1-c.deathP)*(1-e)))))},defLabor:B,capitalGroup:$,accum:S,threshold:I,clean:M,groupType:x,indexedFilter:function(r){return function(e){return A2(a.foldl,F2(function(e,t){return function(){switch(e.ctor){case"_Tuple2":return A2(r,e._0,e._1)?A2(a.push,e._1,t):t}o.Case(i,"between lines 95 and 97")}()}),a.empty)(K(F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}))(e))}},foldFromLeft:W,foldFromBottom:X,indexedFoldFromLeft:Q,indexedFoldFromBottom:V,indexedFoldl:Z,indexedMap:K,filterMap:O,maybeCons:P,index:Y,reverse:C,map2:L,indices:H,neighbors:ee,genGroupId:te,maybeToList:b,dirty:function(e){return A2(s.update,A2(p._op["^@"],e,c.groupId),m.map(A2(p.set,M,!1)))},toList:w,foldr:y,fromList:T,mapR:F,combine:g,map:E,empty:v,filter:k,foldl:h},e.Grid.values},Elm.Cell=Elm.Cell||{},Elm.Cell.make=function(e){"use strict";if(e.Cell=e.Cell||{},e.Cell.values)return e.Cell.values;var t=Elm.Native,r=t.Utils.make(e),n=(t.List.make(e),t.Array.make(e),t.Error.make(e),Elm.Basics.make(e),Elm.Either.make(e)),o=Elm.Optics.Lens.make(e),i=Elm.Optics.Prism.make(e),u=Elm.Pseudorandom.make(e),a=Elm.Pseudorandom.Infix.make(e),c=A2(o.Lens,function(e){return e.threshold},F2(function(e,t){return r.replace([["threshold",e]],t)})),s=function(e){return{_:{},threshold:e}},l={ctor:"MkCapital"},m=function(e){return{ctor:"MkLabor",_0:e}},p=A2(i.Prism,m,function(e){return function(){switch(e.ctor){case"MkLabor":return n.Right(e._0)}return n.Left(e)}()}),_=A2(o.Lens,function(e){return e.firmType},F2(function(e,t){return r.replace([["firmType",e]],t)})),f=A2(o.Lens,function(e){return e.birthDate},F2(function(e,t){return r.replace([["birthDate",e]],t)})),A=A2(o.Lens,function(e){return e.groupId},F2(function(e,t){return r.replace([["groupId",e]],t)})),d=A2(o.Lens,function(e){return e.capitalProfit},F2(function(e,t){return r.replace([["capitalProfit",e]],t)})),h=A2(o.Lens,function(e){return e.laborProfit},F2(function(e,t){return r.replace([["laborProfit",e]],t)})),k=A2(o.Lens,function(e){return e.accum},F2(function(e,t){return r.replace([["accum",e]],t)})),v=F6(function(e,t,r,n,o,i){return{_:{},accum:r,birthDate:o,capitalProfit:t,firmType:i,groupId:n,laborProfit:e}}),E=A2(o.Lens,function(e){return e.cost},F2(function(e,t){return r.replace([["cost",e]],t)})),g=function(e){return{_:{},cost:e}},F=function(e){return{ctor:"MkEmpty",_0:e}},T=A2(i.Prism,F,function(e){return function(){switch(e.ctor){case"MkEmpty":return n.Right(e._0)}return n.Left(e)}()}),y=function(e){return{ctor:"MkFirm",_0:e}},w=A2(i.Prism,y,function(e){return function(){switch(e.ctor){case"MkFirm":return n.Right(e._0)}return n.Left(e)}()}),b=A2(a._op["<$>"],function(e){return g(.3*e)},u.$float),C=F3(function(t,e,r){return A6(v,.077,.033,0,r,e,m(s(function(e){return(.1*1.1-.7*.1)*e/(1-.9*(1-t))})))}),L=F2(function(e,t){return A6(v,.1*.7,.03,0,t,e,l)});return e.Cell.values={_op:{},laborShare:.7,capitalShare:.3,stepProfit:.1,laborAdvantage:1.1,deathP:.1,maxCost:.3,MkFirm:y,MkEmpty:F,firm:w,emptyCell:T,Empty:g,cost:E,Firm:v,accum:k,laborProfit:h,capitalProfit:d,groupId:A,birthDate:f,firmType:_,MkLabor:m,MkCapital:l,labor:p,Labor:s,threshold:c,defLabor:C,defCapital:L,defEmpty:b},e.Cell.values},Elm.Optics=Elm.Optics||{},Elm.Optics.Traversal=Elm.Optics.Traversal||{},Elm.Optics.Traversal.make=function(e){"use strict";if(e.Optics=e.Optics||{},e.Optics.Traversal=e.Optics.Traversal||{},e.Optics.Traversal.values)return e.Optics.Traversal.values;var r={},t=Elm.Native,n=(t.Utils.make(e),t.List.make(e)),o=(t.Array.make(e),t.Error.make(e)),i="Optics.Traversal",u=Elm.Basics.make(e),a=(Elm.Either.make(e),Elm.List.make(e)),c=Elm.Maybe.make(e),s=Elm.Optics.Lens.make(e),l=Elm.Optics.Prism.make(e),m=function(e){return n.fromArray([e])},p=A2(c.maybe,n.fromArray([]),m),_=function(e){return e.set};r["#~"]=_;var f=function(e){return e.view};r["^#"]=u.flip(f);var A=function(r){return function(e){return t=f(r)(e),function(){switch(t.ctor){case"::":return c.Just(t._0);case"[]":return c.Nothing}o.Case(i,"between lines 28 and 30")}();var t}};r["!#"]=u.flip(A);var d=F3(function(e,t,r){return A3(_,e,a.map(t)(A2(f,e,r)),r)});r["#%"]=d;var h=F2(function(e,t){return{_:{},set:t,view:e}});r["##"]=F2(function(r,n){return A2(h,function(e){return a.concatMap(f(n))(f(r)(e))},function(t){return A2(d,r,function(e){return A3(_,n,t,e)})})});var k=function(n){return A2(h,function(e){return p(l.preview(n)(e))},F2(function(t,r){return function(){var e=n.matching(r);switch(e.ctor){case"Left":return e._0;case"Right":return A3(l.set,n,a.head(t),r)}o.Case(i,"between lines 60 and 62")}()}))};r["#?"]=F2(function(e,t){return A2(r["##"],e,k(t))}),r["?#"]=F2(function(e,t){return A2(r["##"],k(e),t)}),r["?#?"]=F2(function(e,t){return A2(r["##"],k(e),k(t))});var v=function(t){return A2(h,function(e){return m(s.view(t)(e))},function(e){return function(){switch(e.ctor){case"::":switch(e._1.ctor){case"[]":return A2(s.set,t,e._0)}}o.Case(i,"on line 66, column 30 to 40")}()})};return r["#@"]=F2(function(e,t){return A2(r["##"],e,v(t))}),r["@#"]=F2(function(e,t){return A2(r["##"],v(e),t)}),r["?@"]=F2(function(e,t){return A2(r["##"],k(e),v(t))}),r["@?"]=F2(function(e,t){return A2(r["##"],v(e),k(t))}),r["@#@"]=F2(function(e,t){return A2(r["##"],v(e),v(t))}),e.Optics.Traversal.values={_op:r,Traversal:h,view:f,preview:A,set:_,over:d,single:m,maybeToList:p,pToT:k,lToT:v},e.Optics.Traversal.values},Elm.Optics=Elm.Optics||{},Elm.Optics.Lens=Elm.Optics.Lens||{},Elm.Optics.Lens.make=function(e){"use strict";if(e.Optics=e.Optics||{},e.Optics.Lens=e.Optics.Lens||{},e.Optics.Lens.values)return e.Optics.Lens.values;var t={},r=Elm.Native,n=(r.Utils.make(e),r.List.make(e),r.Array.make(e),r.Error.make(e)),o="Optics.Lens",i=Elm.Basics.make(e),u=function(e){return e.set};t["@~"]=u;var a=function(e){return e.view};t["^@"]=i.flip(a);var c=F3(function(e,t,r){return A3(u,e,t(A2(a,e,r)),r)});t["@%"]=c;var s=F2(function(e,t){return{_:{},set:t,view:e}});t["@@"]=F2(function(t,r){return A2(s,function(e){return a(r)(a(t)(e))},function(e){return c(t)(u(r)(e))})});var l=A2(s,i.fst,F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:e,_1:t._1}}n.Case(o,"on line 33, column 32 to 36")}()})),m=A2(s,i.snd,F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:t._0,_1:e}}n.Case(o,"on line 36, column 32 to 36")}()}));return e.Optics.Lens.values={_op:t,set:u,view:a,over:c,fst_:l,snd_:m,Lens:s},e.Optics.Lens.values},Elm.Optics=Elm.Optics||{},Elm.Optics.Prism=Elm.Optics.Prism||{},Elm.Optics.Prism.make=function(e){"use strict";if(e.Optics=e.Optics||{},e.Optics.Prism=e.Optics.Prism||{},e.Optics.Prism.values)return e.Optics.Prism.values;var t={},r=Elm.Native,n=(r.Utils.make(e),r.List.make(e),r.Array.make(e),r.Error.make(e)),o="Optics.Prism",i=Elm.Basics.make(e),u=Elm.Either.make(e),a=Elm.Maybe.make(e),c=F2(function(t,r){return function(e){return A2(u.either,i.identity,i.always(t.inject(r)))(t.matching(e))}});t["?~"]=c;var s=F3(function(t,r,n){return A2(u.either,i.identity,function(e){return A3(c,t,r(e),n)})(t.matching(n))});t["?%"]=s;var l=function(t){return function(e){return A2(u.either,i.always(a.Nothing),a.Just)(t.matching(e))}};t["^?"]=i.flip(l);var m=F2(function(e,t){return{_:{},inject:e,matching:t}});t["??"]=F2(function(t,r){return A2(m,function(e){return t.inject(r.inject(e))},function(e){return A2(u.either,u.Left,function(e){return A2(u.either,function(e){return u.Left(t.inject(e))},u.Right)(r.matching(e))})(t.matching(e))})});var p=A2(m,a.Just,function(e){return function(){switch(e.ctor){case"Just":return u.Right(e._0);case"Nothing":return u.Left(a.Nothing)}n.Case(o,"between lines 36 and 38")}()}),_=A2(m,i.always(a.Nothing),function(e){return function(){switch(e.ctor){case"Just":return u.Left(e);case"Nothing":return u.Right({ctor:"_Tuple0"})}n.Case(o,"between lines 41 and 43")}()});return e.Optics.Prism.values={_op:t,set:c,preview:l,over:s,just_:p,nothing_:_,Prism:m},e.Optics.Prism.values},Elm.Pseudorandom=Elm.Pseudorandom||{},Elm.Pseudorandom.make=function(e){"use strict";if(e.Pseudorandom=e.Pseudorandom||{},e.Pseudorandom.values)return e.Pseudorandom.values;var t=Elm.Native,r=(t.Utils.make(e),t.List.make(e)),n=(t.Array.make(e),t.Error.make(e)),o="Pseudorandom",i=Elm.Array.make(e),u=Elm.Basics.make(e),a=Elm.List.make(e),c=Elm.Pseudorandom.Infix.make(e),s=Elm.Pseudorandom.Internal.make(e),l=F2(function(e,t){return u.fst(t(e))}),m=function(e){return{ctor:"_Tuple2",_0:t=s.xorshift(e),_1:t};var t},p=F2(function(e,t){return A2(c._op["=<<"],e,t)}),_=F2(function(e,t){return A2(c._op["<*>"],e,t)}),f=F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}),A=A2(a.foldr,F2(function(e,t){return A2(c._op["<*>"],A2(c._op["<$>"],F2(function(e,t){return A2(a._op["::"],e,t)}),e),t)}),f(r.fromArray([]))),d=A2(i.foldl,F2(function(e,t){return A2(c._op["<*>"],A2(c._op["<$>"],i.push,e),t)}),f(i.empty)),h=F2(function(e,t){return A2(c._op["<$>"],e,t)});return e.Pseudorandom.values={_op:{},constant:f,andThen:p,combine:A,map:function(t){return function(e){return A(a.map(t)(e))}},$int:m,$float:function(e){return t=m(e),function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:u.toFloat(u.abs(t._0)-1)/(0-s.minInt),_1:t._1}}n.Case(o,"on line 72, column 22 to 54")}();var t},range:function(r){return function(e){return t=m(e),function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:A2(s.roundClamp,r,t._0),_1:t._1}}n.Case(o,"on line 76, column 25 to 43")}();var t}},get:l,mapA:function(t){return function(e){return d(i.map(t)(e))}},combineA:d,lift:h,apply:_},e.Pseudorandom.values},Elm.Pseudorandom=Elm.Pseudorandom||{},Elm.Pseudorandom.Infix=Elm.Pseudorandom.Infix||{},Elm.Pseudorandom.Infix.make=function(e){"use strict";if(e.Pseudorandom=e.Pseudorandom||{},e.Pseudorandom.Infix=e.Pseudorandom.Infix||{},e.Pseudorandom.Infix.values)return e.Pseudorandom.Infix.values;var n={},t=Elm.Native,o=(t.Utils.make(e),t.List.make(e),t.Array.make(e),t.Error.make(e)),i="Pseudorandom.Infix",u=Elm.Basics.make(e);Elm.Pseudorandom.Internal.make(e);return n["=<<"]=F2(function(t,r){return function(e){return u.uncurry(t)(r(e))}}),n["<=<"]=F3(function(e,t,r){return A2(n["=<<"],e,t(r))}),n["<*>"]=F2(function(r,n){return function(e){return t=n(e),function(){switch(t.ctor){case"_Tuple2":return e=r(t._1),function(){switch(e.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:e._0(t._0),_1:e._1}}o.Case(i,"on line 23, column 39 to 46")}()}var e;o.Case(i,"on line 23, column 39 to 56")}();var t}}),n["<$>"]=F2(function(r,n){return function(e){return t=n(e),function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:r(t._0),_1:t._1}}o.Case(i,"on line 18, column 24 to 30")}();var t}}),e.Pseudorandom.Infix.values={_op:n},e.Pseudorandom.Infix.values},Elm.Pseudorandom=Elm.Pseudorandom||{},Elm.Pseudorandom.Internal=Elm.Pseudorandom.Internal||{},Elm.Pseudorandom.Internal.make=function(e){"use strict";if(e.Pseudorandom=e.Pseudorandom||{},e.Pseudorandom.Internal=e.Pseudorandom.Internal||{},e.Pseudorandom.Internal.values)return e.Pseudorandom.Internal.values;var t=Elm.Native,r=(t.Utils.make(e),t.List.make(e),t.Array.make(e),t.Error.make(e)),n=Elm.Basics.make(e),o=Elm.Bitwise.make(e),i=F2(function(e,t){return function(){switch(e.ctor){case"_Tuple2":return e._0+A2(n._op["%"],t-e._0,e._1-e._0+1)}r.Case("Pseudorandom.Internal","on line 23, column 23 to 47")}()});return e.Pseudorandom.Internal.values={_op:{},xorshift:function(e){return t=A2(o.xor,e,A2(o.shiftLeft,e,13)),r=A2(o.xor,t,A2(o.shiftRight,t,17)),A2(o.xor,r,A2(o.shiftLeft,r,5));var t,r},roundClamp:i,maxInt:2147483647,minInt:-2147483648},e.Pseudorandom.Internal.values},Elm.Slider=Elm.Slider||{},Elm.Slider.make=function(e){"use strict";if(e.Slider=e.Slider||{},e.Slider.values)return e.Slider.values;var t=Elm.Native,r=(t.Utils.make(e),t.List.make(e),t.Array.make(e),t.Error.make(e),Elm.Graphics.Element.make(e),Elm.Graphics.Input.make(e),Elm.Native.Slider.make(e).slider),n=F7(function(e,t,r,n,o,i,u){return{_:{},disabled:t,horizontal:e,length:r,max:o,min:n,step:i,value:u}});return e.Slider.values={_op:{},SliderStyle:n,defaultSlider:{_:{},disabled:!1,horizontal:!0,length:100,max:100,min:0,step:1,value:0},slider:r},e.Slider.values},Elm.Ticks=Elm.Ticks||{},Elm.Ticks.make=function(e){"use strict";if(e.Ticks=e.Ticks||{},e.Ticks.values)return e.Ticks.values;var t=Elm.Native,r=(t.Utils.make(e),t.List.make(e)),n=(t.Array.make(e),t.Error.make(e)),o="Ticks",i=Elm.Basics.make(e),u=Elm.Graphics.Element.make(e),a=Elm.Graphics.Input.make(e),c=Elm.Signal.make(e),s=Elm.Time.make(e),l=c.countIf(function(e){return function(){switch(e.ctor){case"Step":return!0}return!1}()}),m=F2(function(e,t){return r=F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return function(){switch(e.ctor){case"_Tuple2":return function(){switch(e._0.ctor){case"Reseed":case"Reset":return{ctor:"_Tuple2",_0:0,_1:e._1}}return{ctor:"_Tuple2",_0:e._1-t._1,_1:t._1}}()}n.Case(o,"between lines 30 and 33")}()}n.Case(o,"between lines 30 and 33")}()}),A2(c._op["<~"],i.fst,A3(c.foldp,r,{ctor:"_Tuple2",_0:0,_1:0},A2(c._op["~"],A2(c._op["<~"],F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}),e),t)));var r}),p=function(e){return function(){switch(e.ctor){case"Play":return!0}return!1}()},_=F2(function(e,t){return r=A2(c._op["~"],A2(c._op["<~"],F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}),A2(s.fpsWhen,30,A2(c._op["<~"],p,t))),e),A2(c._op["<~"],i.floor,A3(c.foldp,F2(function(e,t){return function(){switch(e.ctor){case"_Tuple2":return t+e._0*e._1}n.Case(o,"on line 44, column 48 to 60")}()}),0,r));var r}),f=F2(function(e,t){return c.dropRepeats(A2(c._op["~"],A2(c._op["<~"],F2(function(e,t){return e+t}),A2(m,t,l(t))),A2(m,t,A2(_,e,t))))}),A={ctor:"Reseed"},d={ctor:"Reset"},h={ctor:"Pause"},k=a.input(h),v={ctor:"Play"},E={ctor:"Step"},g=A2(u.flow,u.down,r.fromArray([A2(u.flow,u.right,r.fromArray([A3(a.button,k.handle,v,"Play"),A3(a.button,k.handle,h,"Pause"),A3(a.button,k.handle,E,"Step")])),A2(u.spacer,1,5),A2(u.flow,u.right,r.fromArray([A3(a.button,k.handle,d,"Reset"),A3(a.button,k.handle,A,"Reseed")]))]));return e.Ticks.values={_op:{},playControls:g,Step:E,Play:v,Pause:h,Reset:d,Reseed:A,run:k,playing:p,reset:m,stepTicks:l,playTicks:_,totalTicks:f},e.Ticks.values};
