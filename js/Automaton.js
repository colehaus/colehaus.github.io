Elm.Native.Slider={},Elm.Native.Slider.make=function(r){if(r.Native=r.Native||{},r.Native.Slider=r.Native.Slider||{},r.Native.Slider.values)return r.Native.Slider.values;var n=ElmRuntime.use(ElmRuntime.Render.Utils).newElement,u=Elm.Graphics.Element.make(r).newElement;function a(e){var t=n("input");return t.type="range",t.min=e.styling.min,t.max=e.styling.max,t.step=e.styling.step,t.value=e.styling.value,e.styling.horizontal||(t.orient="vertical",t.style.webkitAppearance="slider-vertical",t.style.writingMode="bt-lr"),e.styling.disabled&&(t.disabled=!0),t.style.display="block",t.style.pointerEvents="auto",t.elm_signal=e.signal,t.elm_handler=e.handler,t.addEventListener("input",function(){r.notify(t.elm_signal.id,t.elm_handler(t.value))}),t}function c(e,t,r){r.styling.disabled?e.disabled=!0:e.disabled=!1,e.elm_signal=r.signal,e.elm_handler=r.handler,e.min=r.styling.min,e.max=r.styling.max,e.step=r.styling.step,e.value=r.styling.value}return r.Native.Slider.values={slider:F3(function(e,t,r){var n=r.length,o=24;if(!r.horizontal){var i=n;n=o,o=i}return A3(u,n,o,{ctor:"Custom",type:"Slider",render:a,update:c,model:{signal:e,handler:t,styling:r}})})}},Elm.Automaton=Elm.Automaton||{},Elm.Automaton.make=function(e){"use strict";if(e.Automaton=e.Automaton||{},e.Automaton.values)return e.Automaton.values;function a(e){return F.leftAligned(F.style(b)(F.toText(e)))}function c(t){return f.group(A2(u.map,function(e){return function(){switch(e.ctor){case"_Tuple2":return f.moveX(_.toFloat(t)*e._0*.95)(f.toForm(a(g.show(e._1))))}m.Case(p,"between lines 85 and 86")}()},C))}function n(e){return t=a("Wealth"),r=A.sizeOf(t),n=function(){switch(r.ctor){case"_Tuple2":return r._0}m.Case(p,"on line 100, column 16 to 34")}(),o=e-n-30,i=A2(A.flow,A.down,l.fromArray([a("Capital-managed firms"),A3(f.collage,o,35,l.fromArray([f.moveY(15)(A2(L,o,k.capitalColor)),f.moveX(_.toFloat(o)/-4*1.95)(c(o)),f.moveY(-15)(A2(L,o,k.laborColor))])),a("Labor-managed firms")])),r=A.sizeOf(i),u=function(){switch(r.ctor){case"_Tuple2":return r._1}m.Case(p,"on line 111, column 16 to 35")}(),A2(A.flow,A.right,l.fromArray([A3(A.container,n,u,A.middle)(t),A2(A.spacer,10,u),i]));var t,r,n,o,i,u}var t,r=Elm.Native,s=r.Utils.make(e),l=r.List.make(e),m=(r.Array.make(e),r.Error.make(e)),p="Automaton",_=Elm.Basics.make(e),o=(Elm.Cell.make(e),Elm.Color.make(e)),f=Elm.Graphics.Collage.make(e),A=Elm.Graphics.Element.make(e),i=Elm.Graphics.Input.make(e),d=Elm.Grid.make(e),u=Elm.List.make(e),h=Elm.Optics.Lens.make(e),k=(Elm.Pseudorandom.make(e),Elm.Render.make(e)),E=Elm.Signal.make(e),v=Elm.Slider.make(e),g=Elm.String.make(e),F=Elm.Text.make(e),T=Elm.Ticks.make(e),y=Elm.Transition.make(e),w=Elm.Window.make(e),b=s.replace([["typeface",l.fromArray(["Open sans"])],["color",A3(o.rgb,24,18,30)]],F.defaultStyle),C=A2(u.indexedMap,F2(function(e,t){return{ctor:"_Tuple2",_0:_.toFloat(e)/3,_1:t}}),l.fromArray([0,1,10,100])),L=F2(function(e,t){return r=A2(o.linear,{ctor:"_Tuple2",_0:_.toFloat(e)/-2,_1:0},{ctor:"_Tuple2",_0:_.toFloat(e)/2,_1:0})(u.map(A2(h.over,h.snd_,function(e){return t(k.toAlpha(e))}))(C)),A2(f.gradient,r,A2(f.rect,_.toFloat(e),10));var r}),P=A2(T.totalTicks,E.constant(.002),T.run.signal),O=F6(function(e,t,r,n,o,i){return s.eq(t,e)?{ctor:"_Tuple4",_0:o,_1:r,_2:n,_3:e}:{ctor:"_Tuple4",_0:(u=y.autoStep(A2(h._op["@~"],d.altruism,i)(o))(r))._0,_1:u._1,_2:n,_3:t};var u}),x=F2(function(r,n){return function(){switch(n.ctor){case"_Tuple4":return function(){switch(r.ctor){case"_Tuple3":switch(r._0){case 0:switch(r._1.ctor){case"Reseed":return{ctor:"_Tuple4",_0:(t=d.init(r._2)(n._1))._0,_1:t._1,_2:n._1,_3:0};case"Reset":return{ctor:"_Tuple4",_0:(e=d.init(r._2)(n._2))._0,_1:e._1,_2:n._2,_3:0}}}switch(r._1.ctor){case"Pause":return{ctor:"_Tuple4",_0:n._0,_1:n._1,_2:n._2,_3:n._3};case"Play":case"Step":return A6(O,n._3,r._0,n._1,n._2,n._0,r._2)}}var e,t;m.Case(p,"between lines 62 and 69")}()}m.Case(p,"between lines 62 and 69")}()}),M=i.input(0),I=A3(v.slider,M.handle,_.identity,s.replace([["max",1],["step",.01]],v.defaultSlider)),S=w.width,N=2348912,R={ctor:"_Tuple4",_0:(t=d.init(0)(N))._0,_1:t._1,_2:N,_3:0},G=A2(E._op["<~"],function(e){return function(){switch(e.ctor){case"_Tuple4":return e._0}m.Case(p,"on line 58, column 26 to 27")}()},A3(E.foldp,x,R,A2(E._op["~"],A2(E._op["~"],A2(E._op["<~"],F3(function(e,t,r){return{ctor:"_Tuple3",_0:e,_1:t,_2:r}}),P),T.run.signal),M.signal))),$=A2(E._op["~"],A2(E._op["~"],A2(E._op["<~"],F3(function(e,t,r){return A2(A.flow,A.down,l.fromArray([n(r),A2(k.render,r,t),A2(A.spacer,1,5),A2(A.flow,A.right,l.fromArray([a("Altruism:"),A2(A.spacer,10,1),I,A2(A.spacer,10,1),a("Generation:"),A2(A.spacer,10,1),a(g.show(e))])),A2(A.spacer,1,5),T.playControls]))}),P),G),S);return e.Automaton.values={_op:{},seed:N,gridLength:25,gridSize:S,main:$,initState:R,altruism:M,altSlider:I,grid:G,update:x,step:O,ticks:P,labelSquish:.95,labels:c,stops:C,legend:L,legends:n,plainText$:a,textStyle:b},e.Automaton.values},Elm.Transition=Elm.Transition||{},Elm.Transition.make=function(e){"use strict";if(e.Transition=e.Transition||{},e.Transition.values)return e.Transition.values;function a(t){return function(e){return i.last(i.sortBy(t)(s.toList(e)))}}function n(e){return A2(E._op["##"],A.groupAt(e),A2(E._op["@#"],A.groupType,A2(E._op["?@"],A.capitalGroup,A.accum)))}var t=Elm.Native,m=t.Utils.make(e),c=t.List.make(e),p=(t.Array.make(e),t.Error.make(e)),_="Transition",s=Elm.Array.make(e),r=Elm.Basics.make(e),f=Elm.Cell.make(e),o=Elm.Dict.make(e),l=Elm.Either.make(e),A=Elm.Grid.make(e),i=Elm.List.make(e),d=Elm.Maybe.make(e),h=Elm.Optics.Lens.make(e),k=Elm.Optics.Prism.make(e),E=Elm.Optics.Traversal.make(e),v=Elm.Pseudorandom.make(e),g=Elm.Pseudorandom.Infix.make(e),u=o.map(A2(h.set,A.clean,!0)),F=o.filter(F2(function(e,t){return r.not(A2(h._op["^@"],t,A.clean))})),T=F3(function(e,t,r){return function(){switch(e.ctor){case"Left":return A2(E._op["#%"],A2(E._op["@#"],A.groups,n(e._0)),function(e){return e-t})(r);case"Right":return A2(E._op["#%"],A2(E._op["@#"],A.grid,A2(E._op["##"],A.index(e._0),A2(E._op["?@"],f.firm,f.accum))),function(e){return e-t})(r)}p.Case(_,"between lines 107 and 109")}()}),y=A2(r.flip,d.maybe,r.identity),w=F2(function(t,e){return function(){switch(A2(h._op["^@"],t,f.firmType).ctor){case"MkCapital":return{ctor:"_Tuple2",_0:A2(h._op["@%"],f.accum,F2(function(e,t){return e+t})(A2(h._op["^@"],t,f.laborProfit)))(t),_1:A2(E._op["#%"],n(A2(h._op["^@"],t,f.groupId)),F2(function(e,t){return e+t})(A2(h._op["^@"],t,f.capitalProfit)))(e)};case"MkLabor":return{ctor:"_Tuple2",_0:A2(h._op["@%"],f.accum,function(e){return e+A2(h._op["^@"],t,f.laborProfit)+A2(h._op["^@"],t,f.capitalProfit)})(t),_1:e}}p.Case(_,"between lines 60 and 68")}()}),b=F5(function(a,c,s,l,e){return function(){var u=A2(k._op["^?"],e,f.firm);switch(u.ctor){case"Just":return A2(g._op["<$>"],function(e){return m.cmp(e,.2)<0?function(){var e,t,r,n,o,i=A2(h._op["^@"],u._0,f.firmType);switch(i.ctor){case"MkCapital":return r=A2(h._op["^@"],u._0,f.groupId),t=A2(E._op["!#"],c,A2(E._op["##"],A.groupAt(r),A2(E._op["@?"],A.groupType,A.capitalGroup))),n=function(){switch(t.ctor){case"Just":return t._0}p.Case(_,"on line 155, column 37 to 38")}(),o=A2(h._op["^@"],n,A.accum),m.cmp(A2(h._op["^@"],s,f.cost),o)<0&&m.cmp(A2(h._op["^@"],s,f.cost),A2(h._op["^@"],n,A.threshold))<0?d.Just({ctor:"_Tuple3",_0:A2(h._op["^@"],n,A.threshold),_1:r,_2:d.Nothing}):d.Nothing;case"MkLabor":return e=A2(h._op["^@"],u._0,f.accum),m.cmp(A2(h._op["^@"],s,f.cost),e)<0&&m.cmp(A2(h._op["^@"],s,f.cost),A2(h._op["^@"],i._0,f.threshold)(a))<0?d.Just({ctor:"_Tuple3",_0:A2(h._op["^@"],i._0,f.threshold)(a),_1:A2(h._op["^@"],u._0,f.groupId),_2:d.Just(l)}):d.Nothing}p.Case(_,"between lines 147 and 161")}():d.Nothing},v.$float);case"Nothing":return v.constant(d.Nothing)}p.Case(_,"between lines 141 and 161")}()}),C=F3(function(i,e,u){return A2(g._op["=<<"],function(e){return m.eq(e,s.empty)?v.constant(d.Nothing):(t=A2(h._op["^@"],i,A.generation),r=A2(a,function(e){return function(){switch(e.ctor){case"_Tuple3":return e._0}p.Case(_,"on line 119, column 53 to 54")}()},e),n=function(){switch(r.ctor){case"_Tuple3":return r._1}p.Case(_,"on line 119, column 28 to 65")}(),o=function(){switch(r.ctor){case"_Tuple3":return r._2}p.Case(_,"on line 119, column 28 to 65")}(),function(){switch(o.ctor){case"Just":return A2(g._op["<$>"],function(e){return d.Just({ctor:"_Tuple3",_0:A3(f.defLabor,.2*e,t,n),_1:A2(h._op["^@"],u,f.cost),_2:l.Right(o._0)})},v.$float);case"Nothing":return v.constant(d.Just({ctor:"_Tuple3",_0:A2(f.defCapital,t,n),_1:A2(h._op["^@"],u,f.cost),_2:l.Left(n)}))}p.Case(_,"between lines 121 and 129")}());var t,r,n,o},v.lift(A.filterMap(r.identity))(A.combine(A.indexedMap(A3(b,A2(h._op["^@"],i,A.altruism),A2(h._op["^@"],i,A.groups),u))(A2(A.neighbors,A2(h._op["^@"],i,A.grid),e)))))}),L=A2(g._op["=<<"],function(e){return m.cmp(e,.1)<0?A2(g._op["<$>"],d.Just,f.defEmpty):v.constant(d.Nothing)},v.$float),P=F3(function(t,r,n){return A2(g._op["=<<"],function(e){return m.cmp(e,.001)<0?A2(g._op["<$>"],function(e){return d.Just({ctor:"_Tuple2",_0:A2(f.defCapital,t,r),_1:A2(E._op["#~"],A.groupAt(r),c.fromArray([A.defCapital(.2*e)]))(n)})},v.$float):m.cmp(e,.002)<0?A2(g._op["<$>"],function(e){return d.Just({ctor:"_Tuple2",_0:A3(f.defLabor,.2*e,t,r),_1:A2(E._op["#~"],A.groupAt(r),c.fromArray([A.defLabor]))(n)})},v.$float):v.constant(d.Nothing)},v.$float)}),O=F3(function(e,i,u){return function(){var o=A2(E._op["!#"],u,A2(E._op["@#"],A.grid,A.index(i)));switch(o.ctor){case"Just":switch(o._0.ctor){case"MkEmpty":return A2(g._op["=<<"],function(e){return function(){switch(e.ctor){case"Just":switch(e._0.ctor){case"_Tuple3":return v.constant(A2(h._op["@%"],A.groups,A.dirty(e._0._0))(A2(E._op["#~"],A2(E._op["@#"],A.grid,A.index(i)),c.fromArray([f.MkFirm(e._0._0)]))(A3(T,e._0._2,e._0._1,u))))}break;case"Nothing":return A2(g._op["<$>"],function(e){return function(){switch(e.ctor){case"Just":switch(e._0.ctor){case"_Tuple2":return A2(h._op["@~"],A.groups,e._0._1)(A2(E._op["#~"],A2(E._op["@#"],A.grid,A.index(i)),c.fromArray([f.MkFirm(e._0._0)]))(u))}break;case"Nothing":return u}p.Case(_,"between lines 88 and 93")}()},A3(P,A2(h._op["^@"],u,A.generation),A2(A.genGroupId,A2(h._op["^@"],u,A.generation),i),A2(h._op["^@"],u,A.groups)))}p.Case(_,"between lines 81 and 94")}()},A3(C,e,i,o._0._0));case"MkFirm":return A2(g._op["<$>"],function(n){return function(){switch(n.ctor){case"Just":return A2(E._op["#~"],A2(E._op["@#"],A.grid,A.index(i)),c.fromArray([f.MkEmpty(n._0)]))(u);case"Nothing":return e=A2(w,o._0._0,A2(h._op["^@"],u,A.groups)),t=e._0,r=e._1,A2(h._op["@~"],A.groups,A2(A.dirty,t,r))(A2(E._op["#~"],A2(E._op["@#"],A.grid,A.index(i)),c.fromArray([f.MkFirm(t)]))(u))}var e,t,r;p.Case(_,"between lines 97 and 103")}()},L)}}p.Case(_,"between lines 78 and 103")}()});return e.Transition.values={_op:{},abioP:.001,deathP:.1,claimP:.2,maxDiscount:.2,abiogenesis:P,death:L,accum:w,fromMaybe:y,groupAccum:n,cellStep:O,subCost:T,grow:C,maximumBy:a,claim:b,sweep:F,clean:u,autoStep:function(r){return A2(g._op["<$>"],function(e){return A2(h.over,A.groups,function(e){return u(F(e))})(A2(h.over,A.generation,F2(function(e,t){return e+t})(1))(e))},A3(A.foldl,F2(function(e,t){return A2(g._op["=<<"],A2(O,r,e),t)}),v.constant(r),A.indices))}},e.Transition.values},Elm.Render=Elm.Render||{},Elm.Render.make=function(e){"use strict";if(e.Render=e.Render||{},e.Render.values)return e.Render.values;function s(e){return t=v.solid(e),m.replace([["width",2]],t);var t}function o(e){return d.floor(d.toFloat(e)/d.toFloat(g.length))}function r(e){return v.move({ctor:"_Tuple2",_0:d.toFloat(e)/-2,_1:d.toFloat(e)/-2})}function l(e){return 1-1/A2(d.logBase,d.e,d.e+A2(d.max,e,0))*.8}function i(e){return function(){switch(e.ctor){case"MkEmpty":return a(l(A2(y._op["^@"],e._0,h.cost)));case"MkFirm":return function(){switch(A2(y._op["^@"],e._0,h.firmType).ctor){case"MkCapital":return P(l(A2(y._op["^@"],e._0,h.accum)));case"MkLabor":return c(l(A2(y._op["^@"],e._0,h.accum)))}_.Case(f,"between lines 53 and 55")}()}_.Case(f,"between lines 50 and 55")}()}var t=Elm.Native,m=t.Utils.make(e),p=t.List.make(e),_=(t.Array.make(e),t.Error.make(e)),f="Render",A=Elm.Array.make(e),d=Elm.Basics.make(e),h=Elm.Cell.make(e),k=Elm.Color.make(e),E=Elm.Dict.make(e),v=Elm.Graphics.Collage.make(e),g=(Elm.Graphics.Element.make(e),Elm.Grid.make(e)),F=Elm.List.make(e),T=Elm.Maybe.make(e),y=Elm.Optics.Lens.make(e),w=Elm.Optics.Prism.make(e),b=Elm.Optics.Traversal.make(e),C=F3(function(o,i,u){return function(){switch(u.ctor){case"_Tuple2":return function(){switch(i.ctor){case"_Tuple2":return m.eq(i._1,u._1)?(r=d.toFloat(i._0*o),{ctor:"_Tuple2",_0:n(r+.5),_1:n(r-.5)}):m.eq(i._0,u._0)?(t=d.toFloat(i._1*o),{ctor:"_Tuple2",_0:e(t+.5),_1:e(t-.5)}):_.If(f,"between lines 63 and 70")}function e(e){return A2(v.segment,{ctor:"_Tuple2",_0:d.toFloat(i._0*o),_1:e},{ctor:"_Tuple2",_0:d.toFloat((i._0+1)*o),_1:e})}var t,r;function n(e){return A2(v.segment,{ctor:"_Tuple2",_0:e,_1:d.toFloat(i._1*o)},{ctor:"_Tuple2",_0:e,_1:d.toFloat((i._1+1)*o)})}_.Case(f,"between lines 63 and 70")}()}_.Case(f,"between lines 63 and 70")}()}),n=F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:e(t._0),_1:e(t._1)}}_.Case(f,"on line 35, column 18 to 26")}()}),u=F2(function(e,t){return function(e){return v.move(n(function(e){return d.toFloat(e)*d.toFloat(t)+d.toFloat(t)/2})(e))}}),a=A3(k.rgba,156,69,53),L=A3(k.rgb,215,233,215),c=A3(k.rgba,57,147,57),P=A3(k.rgba,116,46,153),O=F2(function(r,e){return n=o(r),t=F2(function(e,t){return A3(u,r,n,e)(v.filled(i(t))(v.square(d.toFloat(n))))}),v.group(g.toList(A2(g.indexedMap,t,e)));var n,t}),x=F3(function(a,c,e){return r=F3(function(o,i,u){return function(){switch(i.ctor){case"_Tuple2":return function(){switch(o.ctor){case"_Tuple2":return m.eq(A2(b._op["!#"],o._1,A2(b._op["?@"],h.firm,h.groupId)),A2(b._op["!#"],i._1,A2(b._op["?@"],h.firm,h.groupId)))?u:(e=F2(function(n,e){return T.map(function(r){return function(){var e,t;switch(A2(y._op["^@"],r,h.firmType).ctor){case"MkCapital":return e=A2(b._op["!#"],A2(E.getOrFail,A2(y._op["^@"],r,h.groupId),c),A2(b._op["@#"],g.groupType,A2(b._op["?@"],g.capitalGroup,g.accum))),t=function(){switch(e.ctor){case"Just":return e._0}_.Case(f,"on line 87, column 43 to 44")}(),v.group(p.fromArray([A2(v.traced,s(k.white),n),A2(v.traced,s(P(l(t))),n)]));case"MkLabor":return A2(v.traced,s(L),n)}_.Case(f,"between lines 85 and 94")}()})(A2(w._op["^?"],e,h.firm))}),t=A3(C,a,o._0,i._0),r=t._0,n=t._1,A.append(u)(A.fromList(A2(F.filterMap,d.identity,p.fromArray([A2(e,r,o._1),A2(e,n,i._1)])))))}var e,t,r,n;_.Case(f,"between lines 80 and 97")}()}_.Case(f,"between lines 80 and 97")}()}),m.eq(e,A.empty)?A.empty:d.snd(A3(A.foldl,F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:e,_1:A3(r,e,t._0,t._1)}}_.Case(f,"on line 100, column 40 to 58")}()}),{ctor:"_Tuple2",_0:A2(A.getOrFail,0,e),_1:A.empty},A3(A.slice,1,A.length(e),e)));var r}),M=F2(function(e,t){return n=o(e),v.group(A.toList(A2(A.append,r(g.indexedFoldFromBottom),r(g.indexedFoldFromLeft))));function r(e){return A3(e,function(e){return A.append(A2(x,n,A2(y._op["^@"],t,g.groups))(e))},A.empty,A2(y._op["^@"],t,g.grid))}var n}),I=F2(function(e,t){return A3(v.collage,e,e,p.fromArray([r(e)(A2(O,e,A2(y._op["^@"],t,g.grid))),r(e)(A2(M,e,t))]))});return e.Render.values={_op:{},capitalColor:P,laborColor:c,laborAt0:L,emptyColor:a,both:n,toAlpha:l,botLeft:r,positionCell:u,color:i,cellSize:o,border:C,borderStyle:s,lineOfBorders:x,borders:M,cells:O,render:I},e.Render.values},Elm.Grid=Elm.Grid||{},Elm.Grid.make=function(e){"use strict";if(e.Grid=e.Grid||{},e.Grid.values)return e.Grid.values;function n(e){return A2(l.foldl,I(e),l.empty)}function t(e){return{ctor:"MkCapital",_0:e}}function o(t){return function(){switch(t.ctor){case"_Tuple2":return A2(k.Traversal,function(e){return O(l.get(25*t._0+t._1)(e))},function(e){return function(){switch(e.ctor){case"::":switch(e._1.ctor){case"[]":return A2(l.set,25*t._0+t._1,e._0)}}c.Case(s,"on line 143, column 39 to 67")}()})}c.Case(s,"between lines 142 and 143")}()}function i(e){return A2(M,e,K)}var r=Elm.Native,u=r.Utils.make(e),a=r.List.make(e),c=(r.Array.make(e),r.Error.make(e)),s="Grid",l=Elm.Array.make(e),m=Elm.Basics.make(e),p=Elm.Cell.make(e),_=Elm.Dict.make(e),f=Elm.Either.make(e),A=Elm.Maybe.make(e),d=Elm.Optics.Lens.make(e),h=Elm.Optics.Prism.make(e),k=Elm.Optics.Traversal.make(e),E=Elm.Pseudorandom.make(e),v=Elm.Pseudorandom.Infix.make(e),g=l.foldl,F=l.filter,T=l.empty,y=l.map,w=E.combineA,b=E.mapA,C=l.fromList,L=l.foldr,P=l.toList,O=A2(A.maybe,a.fromArray([]),function(e){return a.fromArray([e])}),x=A2(l.foldr,l.push,l.empty),M=F3(function(n,e,t){return o=F2(function(t,r){return function(){var e={ctor:"_Tuple2",_0:A2(l.get,0,t),_1:A2(l.get,0,r)};switch(e.ctor){case"_Tuple2":switch(e._0.ctor){case"Just":switch(e._1.ctor){case"Just":return A2(l.push,A2(n,e._0._0,e._1._0),A2(o,A3(l.slice,1,l.length(t),t),A3(l.slice,1,l.length(r),r)))}}}return l.empty}()}),x(A2(o,e,t));var o}),I=F3(function(t,r,n){return function(){var e=t(r);switch(e.ctor){case"Just":return A2(l.push,e._0,n);case"Nothing":return n}c.Case(s,"between lines 137 and 139")}()}),S=A2(d.Lens,function(e){return e.groupType},F2(function(e,t){return u.replace([["groupType",e]],t)})),N=A2(d.Lens,function(e){return e.clean},F2(function(e,t){return u.replace([["clean",e]],t)})),R=A2(d.Lens,function(e){return e.threshold},F2(function(e,t){return u.replace([["threshold",e]],t)})),G=A2(d.Lens,function(e){return e.accum},F2(function(e,t){return u.replace([["accum",e]],t)})),$=F2(function(e,t){return{_:{},accum:e,threshold:t}}),J={ctor:"MkLabor"},B=A2(h.Prism,t,function(e){return function(){switch(e.ctor){case"MkCapital":return f.Right(e._0)}return f.Left(e)}()}),U=F2(function(e,t){return{_:{},clean:e,groupType:t}}),q=A2(U,!1,J),z=A2(d.Lens,function(e){return e.groups},F2(function(e,t){return u.replace([["groups",e]],t)})),D=A2(d.Lens,function(e){return e.grid},F2(function(e,t){return u.replace([["grid",e]],t)})),j=A2(d.Lens,function(e){return e.altruism},F2(function(e,t){return u.replace([["altruism",e]],t)})),W=A2(d.Lens,function(e){return e.generation},F2(function(e,t){return u.replace([["generation",e]],t)})),X=F4(function(e,t,r,n){return{_:{},altruism:n,generation:r,grid:e,groups:t}}),Y=F3(function(e,t,r){return n=l.length(r),u.eq(n,25)?A2(e,r,t):A3(Y,e,A2(e,A3(l.slice,0,25,r),t),A3(l.slice,25,l.length(r),r));var n}),H=F3(function(n,e,o){return i=F2(function(t,e){return u.eq(t,25)?e:(r=A2(l.initialize,25,function(e){return A2(l.getOrFail,25*e+t,o)}),i(t+1)(A2(n,r,e)));var r}),A2(i,0,e);var i}),K=A2(l.initialize,Math.pow(25,2),function(e){return{ctor:"_Tuple2",_0:e/25|0,_1:A2(m.rem,e,25)}}),Q=F2(function(t,r){return function(e){return A2(Y,t,r)(i(F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}))(e))}}),V=F2(function(t,r){return function(e){return A2(H,t,r)(i(F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}))(e))}}),Z=F3(function(r,e,t){return A2(l.foldl,F2(function(e,t){return function(){switch(e.ctor){case"_Tuple2":return A3(r,e._0,e._1,t)}c.Case(s,"on line 126, column 49 to 58")}()}),e)(A2(i,F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}),t))}),ee=F2(function(r,e){return function(){switch(e.ctor){case"_Tuple2":return n(function(e){return function(){switch(e.ctor){case"_Tuple2":return t(e._0)&&t(e._1)?A2(k._op["!#"],r,o({ctor:"_Tuple2",_0:e._0,_1:e._1})):A.Nothing}c.Case(s,"between lines 164 and 166")}()})(l.fromList(a.fromArray([{ctor:"_Tuple2",_0:e._0+1,_1:e._1},{ctor:"_Tuple2",_0:e._0-1,_1:e._1},{ctor:"_Tuple2",_0:e._0,_1:e._1+1},{ctor:"_Tuple2",_0:e._0,_1:e._1-1}])))}function t(e){return-1<u.cmp(e,0)&&u.cmp(e,25)<0}c.Case(s,"between lines 162 and 171")}()}),te=F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return(25*t._0+t._1)*e}c.Case(s,"on line 174, column 24 to 43")}()});return e.Grid.values={_op:{},length:25,init:function(t){return A2(v._op["<$>"],function(e){return A4(X,e,_.empty,1,t)},E.combineA(A2(l.repeat,Math.pow(25,2),A2(v._op["<$>"],p.MkEmpty,p.defEmpty))))},Automaton:X,groupAt:function(r){return A2(k.Traversal,function(e){return O(_.get(r)(e))},F2(function(e,t){return function(){switch(e.ctor){case"::":switch(e._1.ctor){case"[]":return A3(_.insert,r,e._0,t)}break;case"[]":return A2(_.remove,r,t)}c.Case(s,"between lines 44 and 46")}()}))},generation:W,altruism:j,grid:D,groups:z,Group:U,MkCapital:t,MkLabor:J,CapitalGroup:$,defCapital:function(e){return U(!1)(t($(0)(p.capitalShare*p.stepProfit/(1-(1-p.deathP)*(1-e)))))},defLabor:q,capitalGroup:B,accum:G,threshold:R,clean:N,groupType:S,indexedFilter:function(r){return function(e){return A2(l.foldl,F2(function(e,t){return function(){switch(e.ctor){case"_Tuple2":return A2(r,e._0,e._1)?A2(l.push,e._1,t):t}c.Case(s,"between lines 95 and 97")}()}),l.empty)(i(F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}))(e))}},foldFromLeft:Y,foldFromBottom:H,indexedFoldFromLeft:Q,indexedFoldFromBottom:V,indexedFoldl:Z,indexedMap:i,filterMap:n,maybeCons:I,index:o,reverse:x,map2:M,indices:K,neighbors:ee,genGroupId:te,maybeToList:O,dirty:function(e){return A2(_.update,A2(d._op["^@"],e,p.groupId),A.map(A2(d.set,N,!1)))},toList:P,foldr:L,fromList:C,mapR:b,combine:w,map:y,empty:T,filter:F,foldl:g},e.Grid.values},Elm.Cell=Elm.Cell||{},Elm.Cell.make=function(e){"use strict";if(e.Cell=e.Cell||{},e.Cell.values)return e.Cell.values;function n(e){return{_:{},threshold:e}}function o(e){return{ctor:"MkLabor",_0:e}}function t(e){return{_:{},cost:e}}function r(e){return{ctor:"MkEmpty",_0:e}}function i(e){return{ctor:"MkFirm",_0:e}}var u=Elm.Native,a=u.Utils.make(e),c=(u.List.make(e),u.Array.make(e),u.Error.make(e),Elm.Basics.make(e),Elm.Either.make(e)),s=Elm.Optics.Lens.make(e),l=Elm.Optics.Prism.make(e),m=Elm.Pseudorandom.make(e),p=Elm.Pseudorandom.Infix.make(e),_=A2(s.Lens,function(e){return e.threshold},F2(function(e,t){return a.replace([["threshold",e]],t)})),f={ctor:"MkCapital"},A=A2(l.Prism,o,function(e){return function(){switch(e.ctor){case"MkLabor":return c.Right(e._0)}return c.Left(e)}()}),d=A2(s.Lens,function(e){return e.firmType},F2(function(e,t){return a.replace([["firmType",e]],t)})),h=A2(s.Lens,function(e){return e.birthDate},F2(function(e,t){return a.replace([["birthDate",e]],t)})),k=A2(s.Lens,function(e){return e.groupId},F2(function(e,t){return a.replace([["groupId",e]],t)})),E=A2(s.Lens,function(e){return e.capitalProfit},F2(function(e,t){return a.replace([["capitalProfit",e]],t)})),v=A2(s.Lens,function(e){return e.laborProfit},F2(function(e,t){return a.replace([["laborProfit",e]],t)})),g=A2(s.Lens,function(e){return e.accum},F2(function(e,t){return a.replace([["accum",e]],t)})),F=F6(function(e,t,r,n,o,i){return{_:{},accum:r,birthDate:o,capitalProfit:t,firmType:i,groupId:n,laborProfit:e}}),T=A2(s.Lens,function(e){return e.cost},F2(function(e,t){return a.replace([["cost",e]],t)})),y=A2(l.Prism,r,function(e){return function(){switch(e.ctor){case"MkEmpty":return c.Right(e._0)}return c.Left(e)}()}),w=A2(l.Prism,i,function(e){return function(){switch(e.ctor){case"MkFirm":return c.Right(e._0)}return c.Left(e)}()}),b=A2(p._op["<$>"],function(e){return t(.3*e)},m.$float),C=F3(function(t,e,r){return A6(F,.077,.033,0,r,e,o(n(function(e){return(.1*1.1-.7*.1)*e/(1-.9*(1-t))})))}),L=F2(function(e,t){return A6(F,.1*.7,.03,0,t,e,f)});return e.Cell.values={_op:{},laborShare:.7,capitalShare:.3,stepProfit:.1,laborAdvantage:1.1,deathP:.1,maxCost:.3,MkFirm:i,MkEmpty:r,firm:w,emptyCell:y,Empty:t,cost:T,Firm:F,accum:g,laborProfit:v,capitalProfit:E,groupId:k,birthDate:h,firmType:d,MkLabor:o,MkCapital:f,labor:A,Labor:n,threshold:_,defLabor:C,defCapital:L,defEmpty:b},e.Cell.values},Elm.Optics=Elm.Optics||{},Elm.Optics.Traversal=Elm.Optics.Traversal||{},Elm.Optics.Traversal.make=function(e){"use strict";if(e.Optics=e.Optics||{},e.Optics.Traversal=e.Optics.Traversal||{},e.Optics.Traversal.values)return e.Optics.Traversal.values;function r(e){return i.fromArray([e])}function o(e){return e.set}var n={},t=Elm.Native,i=(t.Utils.make(e),t.List.make(e)),u=(t.Array.make(e),t.Error.make(e)),a="Optics.Traversal",c=Elm.Basics.make(e),s=(Elm.Either.make(e),Elm.List.make(e)),l=Elm.Maybe.make(e),m=Elm.Optics.Lens.make(e),p=Elm.Optics.Prism.make(e),_=A2(l.maybe,i.fromArray([]),r);n["#~"]=o;function f(e){return e.view}n["^#"]=c.flip(f);function A(r){return function(e){return t=f(r)(e),function(){switch(t.ctor){case"::":return l.Just(t._0);case"[]":return l.Nothing}u.Case(a,"between lines 28 and 30")}();var t}}n["!#"]=c.flip(A);var d=F3(function(e,t,r){return A3(o,e,s.map(t)(A2(f,e,r)),r)});n["#%"]=d;var h=F2(function(e,t){return{_:{},set:t,view:e}});n["##"]=F2(function(r,n){return A2(h,function(e){return s.concatMap(f(n))(f(r)(e))},function(t){return A2(d,r,function(e){return A3(o,n,t,e)})})});function k(n){return A2(h,function(e){return _(p.preview(n)(e))},F2(function(t,r){return function(){var e=n.matching(r);switch(e.ctor){case"Left":return e._0;case"Right":return A3(p.set,n,s.head(t),r)}u.Case(a,"between lines 60 and 62")}()}))}n["#?"]=F2(function(e,t){return A2(n["##"],e,k(t))}),n["?#"]=F2(function(e,t){return A2(n["##"],k(e),t)}),n["?#?"]=F2(function(e,t){return A2(n["##"],k(e),k(t))});function E(t){return A2(h,function(e){return r(m.view(t)(e))},function(e){return function(){switch(e.ctor){case"::":switch(e._1.ctor){case"[]":return A2(m.set,t,e._0)}}u.Case(a,"on line 66, column 30 to 40")}()})}return n["#@"]=F2(function(e,t){return A2(n["##"],e,E(t))}),n["@#"]=F2(function(e,t){return A2(n["##"],E(e),t)}),n["?@"]=F2(function(e,t){return A2(n["##"],k(e),E(t))}),n["@?"]=F2(function(e,t){return A2(n["##"],E(e),k(t))}),n["@#@"]=F2(function(e,t){return A2(n["##"],E(e),E(t))}),e.Optics.Traversal.values={_op:n,Traversal:h,view:f,preview:A,set:o,over:d,single:r,maybeToList:_,pToT:k,lToT:E},e.Optics.Traversal.values},Elm.Optics=Elm.Optics||{},Elm.Optics.Lens=Elm.Optics.Lens||{},Elm.Optics.Lens.make=function(e){"use strict";if(e.Optics=e.Optics||{},e.Optics.Lens=e.Optics.Lens||{},e.Optics.Lens.values)return e.Optics.Lens.values;function n(e){return e.set}var t={},r=Elm.Native,o=(r.Utils.make(e),r.List.make(e),r.Array.make(e),r.Error.make(e)),i="Optics.Lens",u=Elm.Basics.make(e);t["@~"]=n;function a(e){return e.view}t["^@"]=u.flip(a);var c=F3(function(e,t,r){return A3(n,e,t(A2(a,e,r)),r)});t["@%"]=c;var s=F2(function(e,t){return{_:{},set:t,view:e}});t["@@"]=F2(function(t,r){return A2(s,function(e){return a(r)(a(t)(e))},function(e){return c(t)(n(r)(e))})});var l=A2(s,u.fst,F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:e,_1:t._1}}o.Case(i,"on line 33, column 32 to 36")}()})),m=A2(s,u.snd,F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:t._0,_1:e}}o.Case(i,"on line 36, column 32 to 36")}()}));return e.Optics.Lens.values={_op:t,set:n,view:a,over:c,fst_:l,snd_:m,Lens:s},e.Optics.Lens.values},Elm.Optics=Elm.Optics||{},Elm.Optics.Prism=Elm.Optics.Prism||{},Elm.Optics.Prism.make=function(e){"use strict";if(e.Optics=e.Optics||{},e.Optics.Prism=e.Optics.Prism||{},e.Optics.Prism.values)return e.Optics.Prism.values;var t={},r=Elm.Native,n=(r.Utils.make(e),r.List.make(e),r.Array.make(e),r.Error.make(e)),o="Optics.Prism",i=Elm.Basics.make(e),u=Elm.Either.make(e),a=Elm.Maybe.make(e),c=F2(function(t,r){return function(e){return A2(u.either,i.identity,i.always(t.inject(r)))(t.matching(e))}});t["?~"]=c;var s=F3(function(t,r,n){return A2(u.either,i.identity,function(e){return A3(c,t,r(e),n)})(t.matching(n))});t["?%"]=s;function l(t){return function(e){return A2(u.either,i.always(a.Nothing),a.Just)(t.matching(e))}}t["^?"]=i.flip(l);var m=F2(function(e,t){return{_:{},inject:e,matching:t}});t["??"]=F2(function(t,r){return A2(m,function(e){return t.inject(r.inject(e))},function(e){return A2(u.either,u.Left,function(e){return A2(u.either,function(e){return u.Left(t.inject(e))},u.Right)(r.matching(e))})(t.matching(e))})});var p=A2(m,a.Just,function(e){return function(){switch(e.ctor){case"Just":return u.Right(e._0);case"Nothing":return u.Left(a.Nothing)}n.Case(o,"between lines 36 and 38")}()}),_=A2(m,i.always(a.Nothing),function(e){return function(){switch(e.ctor){case"Just":return u.Left(e);case"Nothing":return u.Right({ctor:"_Tuple0"})}n.Case(o,"between lines 41 and 43")}()});return e.Optics.Prism.values={_op:t,set:c,preview:l,over:s,just_:p,nothing_:_,Prism:m},e.Optics.Prism.values},Elm.Pseudorandom=Elm.Pseudorandom||{},Elm.Pseudorandom.make=function(e){"use strict";if(e.Pseudorandom=e.Pseudorandom||{},e.Pseudorandom.values)return e.Pseudorandom.values;function n(e){return{ctor:"_Tuple2",_0:t=l.xorshift(e),_1:t};var t}var t=Elm.Native,r=(t.Utils.make(e),t.List.make(e)),o=(t.Array.make(e),t.Error.make(e)),i="Pseudorandom",u=Elm.Array.make(e),a=Elm.Basics.make(e),c=Elm.List.make(e),s=Elm.Pseudorandom.Infix.make(e),l=Elm.Pseudorandom.Internal.make(e),m=F2(function(e,t){return a.fst(t(e))}),p=F2(function(e,t){return A2(s._op["=<<"],e,t)}),_=F2(function(e,t){return A2(s._op["<*>"],e,t)}),f=F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}),A=A2(c.foldr,F2(function(e,t){return A2(s._op["<*>"],A2(s._op["<$>"],F2(function(e,t){return A2(c._op["::"],e,t)}),e),t)}),f(r.fromArray([]))),d=A2(u.foldl,F2(function(e,t){return A2(s._op["<*>"],A2(s._op["<$>"],u.push,e),t)}),f(u.empty)),h=F2(function(e,t){return A2(s._op["<$>"],e,t)});return e.Pseudorandom.values={_op:{},constant:f,andThen:p,combine:A,map:function(t){return function(e){return A(c.map(t)(e))}},$int:n,$float:function(e){return t=n(e),function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:a.toFloat(a.abs(t._0)-1)/(0-l.minInt),_1:t._1}}o.Case(i,"on line 72, column 22 to 54")}();var t},range:function(r){return function(e){return t=n(e),function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:A2(l.roundClamp,r,t._0),_1:t._1}}o.Case(i,"on line 76, column 25 to 43")}();var t}},get:m,mapA:function(t){return function(e){return d(u.map(t)(e))}},combineA:d,lift:h,apply:_},e.Pseudorandom.values},Elm.Pseudorandom=Elm.Pseudorandom||{},Elm.Pseudorandom.Infix=Elm.Pseudorandom.Infix||{},Elm.Pseudorandom.Infix.make=function(e){"use strict";if(e.Pseudorandom=e.Pseudorandom||{},e.Pseudorandom.Infix=e.Pseudorandom.Infix||{},e.Pseudorandom.Infix.values)return e.Pseudorandom.Infix.values;var n={},t=Elm.Native,o=(t.Utils.make(e),t.List.make(e),t.Array.make(e),t.Error.make(e)),i="Pseudorandom.Infix",u=Elm.Basics.make(e);Elm.Pseudorandom.Internal.make(e);return n["=<<"]=F2(function(t,r){return function(e){return u.uncurry(t)(r(e))}}),n["<=<"]=F3(function(e,t,r){return A2(n["=<<"],e,t(r))}),n["<*>"]=F2(function(r,n){return function(e){return t=n(e),function(){switch(t.ctor){case"_Tuple2":return e=r(t._1),function(){switch(e.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:e._0(t._0),_1:e._1}}o.Case(i,"on line 23, column 39 to 46")}()}var e;o.Case(i,"on line 23, column 39 to 56")}();var t}}),n["<$>"]=F2(function(r,n){return function(e){return t=n(e),function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:r(t._0),_1:t._1}}o.Case(i,"on line 18, column 24 to 30")}();var t}}),e.Pseudorandom.Infix.values={_op:n},e.Pseudorandom.Infix.values},Elm.Pseudorandom=Elm.Pseudorandom||{},Elm.Pseudorandom.Internal=Elm.Pseudorandom.Internal||{},Elm.Pseudorandom.Internal.make=function(e){"use strict";if(e.Pseudorandom=e.Pseudorandom||{},e.Pseudorandom.Internal=e.Pseudorandom.Internal||{},e.Pseudorandom.Internal.values)return e.Pseudorandom.Internal.values;var t=Elm.Native,r=(t.Utils.make(e),t.List.make(e),t.Array.make(e),t.Error.make(e)),n=Elm.Basics.make(e),o=Elm.Bitwise.make(e),i=F2(function(e,t){return function(){switch(e.ctor){case"_Tuple2":return e._0+A2(n._op["%"],t-e._0,e._1-e._0+1)}r.Case("Pseudorandom.Internal","on line 23, column 23 to 47")}()});return e.Pseudorandom.Internal.values={_op:{},xorshift:function(e){return t=A2(o.xor,e,A2(o.shiftLeft,e,13)),r=A2(o.xor,t,A2(o.shiftRight,t,17)),A2(o.xor,r,A2(o.shiftLeft,r,5));var t,r},roundClamp:i,maxInt:2147483647,minInt:-2147483648},e.Pseudorandom.Internal.values},Elm.Slider=Elm.Slider||{},Elm.Slider.make=function(e){"use strict";if(e.Slider=e.Slider||{},e.Slider.values)return e.Slider.values;var t=Elm.Native,r=(t.Utils.make(e),t.List.make(e),t.Array.make(e),t.Error.make(e),Elm.Graphics.Element.make(e),Elm.Graphics.Input.make(e),Elm.Native.Slider.make(e).slider),n=F7(function(e,t,r,n,o,i,u){return{_:{},disabled:t,horizontal:e,length:r,max:o,min:n,step:i,value:u}});return e.Slider.values={_op:{},SliderStyle:n,defaultSlider:{_:{},disabled:!1,horizontal:!0,length:100,max:100,min:0,step:1,value:0},slider:r},e.Slider.values},Elm.Ticks=Elm.Ticks||{},Elm.Ticks.make=function(e){"use strict";if(e.Ticks=e.Ticks||{},e.Ticks.values)return e.Ticks.values;function n(e){return function(){switch(e.ctor){case"Play":return!0}return!1}()}var t=Elm.Native,r=(t.Utils.make(e),t.List.make(e)),o=(t.Array.make(e),t.Error.make(e)),i="Ticks",u=Elm.Basics.make(e),a=Elm.Graphics.Element.make(e),c=Elm.Graphics.Input.make(e),s=Elm.Signal.make(e),l=Elm.Time.make(e),m=s.countIf(function(e){return function(){switch(e.ctor){case"Step":return!0}return!1}()}),p=F2(function(e,t){return r=F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return function(){switch(e.ctor){case"_Tuple2":return function(){switch(e._0.ctor){case"Reseed":case"Reset":return{ctor:"_Tuple2",_0:0,_1:e._1}}return{ctor:"_Tuple2",_0:e._1-t._1,_1:t._1}}()}o.Case(i,"between lines 30 and 33")}()}o.Case(i,"between lines 30 and 33")}()}),A2(s._op["<~"],u.fst,A3(s.foldp,r,{ctor:"_Tuple2",_0:0,_1:0},A2(s._op["~"],A2(s._op["<~"],F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}),e),t)));var r}),_=F2(function(e,t){return r=A2(s._op["~"],A2(s._op["<~"],F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}),A2(l.fpsWhen,30,A2(s._op["<~"],n,t))),e),A2(s._op["<~"],u.floor,A3(s.foldp,F2(function(e,t){return function(){switch(e.ctor){case"_Tuple2":return t+e._0*e._1}o.Case(i,"on line 44, column 48 to 60")}()}),0,r));var r}),f=F2(function(e,t){return s.dropRepeats(A2(s._op["~"],A2(s._op["<~"],F2(function(e,t){return e+t}),A2(p,t,m(t))),A2(p,t,A2(_,e,t))))}),A={ctor:"Reseed"},d={ctor:"Reset"},h={ctor:"Pause"},k=c.input(h),E={ctor:"Play"},v={ctor:"Step"},g=A2(a.flow,a.down,r.fromArray([A2(a.flow,a.right,r.fromArray([A3(c.button,k.handle,E,"Play"),A3(c.button,k.handle,h,"Pause"),A3(c.button,k.handle,v,"Step")])),A2(a.spacer,1,5),A2(a.flow,a.right,r.fromArray([A3(c.button,k.handle,d,"Reset"),A3(c.button,k.handle,A,"Reseed")]))]));return e.Ticks.values={_op:{},playControls:g,Step:v,Play:E,Pause:h,Reset:d,Reseed:A,run:k,playing:n,reset:p,stepTicks:m,playTicks:_,totalTicks:f},e.Ticks.values};
